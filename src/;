/// <reference lib="webworker" />

import * as si from 'systeminformation';

import { Display } from '../../shared/models/display';

addEventListener('message', (message) => {
  onMessage(message)
});

async function onMessage(message): Promise<void> {
  console.time('worker');
  const displays = await getDisplays();
  await new Promise((res, rej) => setTimeout(res, 5000));
  postMessage(JSON.stringify(displays));
  console.timeEnd('worker');
}

async function getDisplays(): Promise<Display[]> {
  const graphics = await si.graphics();
  return graphics.displays;
}
